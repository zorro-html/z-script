<script>
  (function (global) {
    function getBaseURI(doc) {
      var script = doc._currentScript || doc.currentScript;
      var assetpath = script.parentNode.getAttribute('assetpath');
      return getFullURL(assetpath, script.baseURI);
    }

    function getFullURL(url, baseURI) {
      var frame = document.createElement("iframe");
      frame.style.display = "none";
      document.body.appendChild(frame);

      var doc = frame.contentDocument;

      var base = doc.createElement("base");
      base.href = baseURI || '';
      doc.head.appendChild(base);

      var anchor = doc.createElement('a');
      anchor.setAttribute('href', url || '');
      
      var fullUrl = anchor.href;

      document.body.removeChild(frame);

      return fullUrl;
    }

    global.getBaseURI = getBaseURI;
    global.getFullURL = getFullURL;
  })(this);
</script>
